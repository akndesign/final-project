<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <title>Underground Status</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://use.typekit.net/qnk1ava.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="/js/moment.min.js"></script>
    <script type="text/javascript" src= "/js/moment-timezone.min.js"></script>
    <script type="text/javascript">
    $(window).load(function() {
    $('#loading').remove();
    });
    </script>  

     <!-- Loading Bootstrap -->
    <link href="css/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Loading Flat UI -->
    <link rel="stylesheet" href="css/tube.css">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/flat-ui.css" >
    <link rel="shortcut icon" href="img/favicon.ico">
    <script src="js/main.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
     // Your Client ID can be retrieved from your project in the Google
      // Developer Console, https://console.developers.google.com
      var CLIENT_ID = '559328610579-le432q0suco7hf1l4mohephcsvss0amm.apps.googleusercontent.com';

      var SCOPES = ["https://www.googleapis.com/auth/calendar.readonly"];

      /**
       * Check if current user has authorized this application.
       */
      function checkAuth() {
        gapi.auth.authorize(
          {
            'client_id': CLIENT_ID,
            'scope': SCOPES.join(' '),
            'immediate': true
          }, handleAuthResult);
      }

      console.log(gapi.auth.authorize);
      /**
       * Handle response from authorization server.
       *
       * @param {Object} authResult Authorization result.
       */
      function handleAuthResult(authResult) {
        var authorizeDiv = document.getElementById('authorize-div');
        if (authResult && !authResult.error) {
          // Hide auth UI, then load client library.
          authorizeDiv.style.display = 'none';
          loadCalendarApi();
        } else {
          // Show auth UI, allowing the user to initiate authorization by
          // clicking authorize button.
          authorizeDiv.style.display = 'inline';
        }
      }

      /**
       * Initiate auth flow in response to user clicking authorize button.
       *
       * @param {Event} event Button click event.
       */
      function handleAuthClick(event) {
        gapi.auth.authorize(
          {client_id: CLIENT_ID, scope: SCOPES, immediate: false},
          handleAuthResult);
        return false;
      }

      /**
       * Load Google Calendar client library. List upcoming events
       * once client library is loaded.
       */
      function loadCalendarApi() {
        gapi.client.load('calendar', 'v3', listUpcomingEvents);
      }

      /**
       * Print the summary and start datetime/date of the next ten events in
       * the authorized users calendar. If no events are found an
       * appropriate message is printed.
       */

      function listUpcomingEvents() {
        var request = gapi.client.calendar.events.list({
          'calendarId': 'primary',
          'timeMin': (new Date()).toISOString(),
          'showDeleted': false,
          'singleEvents': true,
          'maxResults': 10,
          'orderBy': 'startTime'
        });

        request.execute(function(resp) {
          var events = resp.items;
          appendPre('Upcoming events:');

          if (events.length > 0) {
            for (i = 0; i < events.length; i++) {
              var event = events[i];
              var when = event.start.dateTime;
              if (!when) {
                when = event.start.date;
              }
              appendPre(event.summary + ' (' + when + ')')
            }
          } else {
            appendPre('No upcoming events found.');
          }

        });
      }

      /**
       * Append a pre element to the body containing the given message
       * as its text node.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('googleCalendar');
        var textContent = document.createTextNode(message + '\n');
        pre.appendChild(textContent);
      }

    </script>
  </head>

    <!--Future Feature, Search by City
    <input id="city" name="city" class="form" autocomplete="off" data-country="us"></input>
    <button id="search-button">Search</button>
    <button id="Reset">Reset Field</button>-->
 <body>
    <div class="widget-window row">
    <div id="loading">
  <svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
     width="40px" height="40px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">
  <path fill="#fff" d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z">
    <animateTransform attributeType="xml"
      attributeName="transform"
      type="rotate"
      from="0 25 25"
      to="360 25 25"
      dur="0.6s"
      repeatCount="indefinite"/>
    </path>
  </svg>
</div>
    <div class="service-board toggle col-xs-4">
        <div id="service-notifications" class="overlay">
            <li id="good-service"></li>
            <li id="interruptions"><span class="title"></span></li>
            <li id="service-closed"><span class="status-title"></li>
        </div>
        <div id="lines">  
            <li id='tfl' class="top-li bakerloo text"></li>
            <li id='tfl' class="central text"></li>
            <li id='tfl' class="circle text"></li>
            <li id='tfl' class="district"></li>
            <li id='tfl' class="hammersmithandcity"></li>
            <li id='tfl' class="jubilee"></li>
            <li id='tfl' class="metropolitan"></li>
            <li id='tfl' class="northern"></li>
            <li id='tfl' class="piccadilly"></li>
            <li id='tfl' class="tram"></li>
            <li id='tfl' class="victoria"></li>
            <li id='tfl' class="bottom-li waterlooandcity"></li>
        </div>
    </div>   
    <div class="weather col-xs-4">
        <h2> London</h2>
        <span id="location"></span>
        <span id="weathercondition"></span>
        <span id="temperature"></span>
    </div>
    
    <div id="asteriod" class="asteriod col-xs-4"></div>
    <div id="output">
        <div id="authorize-div" style="display: none">
        <span>Authorize access to Google Calendar API</span>
      <!--Button for the user to click to initiate auth sequence -->
        <button id="authorize-button" onclick="handleAuthClick(event)"> Authorize </button>
        </div>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://apis.google.com/js/client.js?onload=checkAuth"></script>
    <script src="js/vendor/video.js"></script>
    <script src="js/flat-ui.min.js"></script>
    
    <script>
    </script>

  </body>
</html>
